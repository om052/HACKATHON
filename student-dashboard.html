<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Student Dashboard | Smart Classroom</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif}

body{
  min-height:100vh;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:#fff;
}

/* Layout */
.app{display:flex;min-height:100vh}

/* Sidebar */
.sidebar{
  width:230px;
  background:rgba(255,255,255,0.12);
  backdrop-filter:blur(16px);
  padding:25px;
}
.sidebar h2{margin-bottom:30px;font-size:1.3rem}
.sidebar a{
  display:block;
  padding:10px 14px;
  margin-bottom:10px;
  border-radius:10px;
  text-decoration:none;
  color:#fff;
  font-size:.9rem;
}
.sidebar a.active,.sidebar a:hover{
  background:rgba(255,255,255,0.2);
}

/* Main */
.main{flex:1;padding:25px}

/* Topbar */
.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:25px;
}
.role{
  background:#9ca3af;
  color:#000;
  padding:4px 12px;
  border-radius:14px;
  font-size:.75rem;
}
.logout{
  background:#ff6b6b;
  border:none;
  padding:8px 16px;
  border-radius:20px;
  cursor:pointer;
}

/* Year Selector */
.year-box{
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:20px;
}
select{
  padding:8px 12px;
  border-radius:10px;
  border:none;
  outline:none;
}

/* Timetable */
.timetable{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:15px;
}
.slot{
  background:rgba(255,255,255,0.15);
  border-radius:16px;
  padding:16px;
  text-align:center;
  box-shadow:0 10px 25px rgba(0,0,0,.3);
}
.slot h4{font-size:.95rem;margin-bottom:6px}
.slot span{font-size:.8rem;opacity:.9}

.substitute{
  background:#fde68a;
  color:#000;
  font-weight:600;
}

/* Empty */
.empty{
  opacity:.8;
  font-size:.9rem;
}
</style>
</head>

<body>

<div class="app">

  <!-- Sidebar -->
  <aside class="sidebar">
    <h2>Smart Classroom</h2>
    <a class="active">Dashboard</a>
    <a>My Timetable</a>
    <a>Notifications</a>
  </aside>

  <!-- Main -->
  <main class="main">

    <!-- Topbar -->
    <div class="topbar">
      <h3 id="welcome"></h3>
      <button class="logout" onclick="logout()">Logout</button>
    </div>

    <!-- Year Selector -->
    <div class="year-box">
      <strong>Select Year:</strong>
      <select id="yearSelect" onchange="loadTimetable()">
        <option value="FE">First Year (FE)</option>
        <option value="SE">Second Year (SE)</option>
        <option value="TE">Third Year (TE)</option>
        <option value="BE">Final Year (BE)</option>
      </select>
    </div>

    <!-- Timetable -->
    <div class="timetable" id="timetable"></div>

  </main>
</div>

<script>
/* üîê Session Check */
const user = JSON.parse(localStorage.getItem("currentUser"));
if(!user || user.role !== "student"){
  location.href="index.html";
}
welcome.innerHTML = `Welcome, ${user.name} <span class="role">Student</span>`;

/* Subjects */
const subjects={
  FE:["Maths","Physics","Chemistry","English"],
  SE:["DSA","OOP","DBMS","Maths"],
  TE:["OS","CN","AI","SE"],
  BE:["Project","ML","Cloud","Elective"]
};

/* Load Timetable */
function loadTimetable(){
  const year=document.getElementById("yearSelect").value;
  const table=document.getElementById("timetable");
  table.innerHTML="";

  const teachers = JSON.parse(localStorage.getItem("admin_teachers")) || [];

  if(!teachers.length){
    table.innerHTML = `<p class="empty">Timetable not generated by Admin yet</p>`;
    return;
  }

  const present = teachers.filter(t=>t.status==="present");

  subjects[year].forEach((sub,i)=>{
    const slot=document.createElement("div");

    if(present[i]){
      slot.className="slot";
      slot.innerHTML=`<h4>${sub}</h4><span>${present[i].id}</span>`;
    }else{
      slot.className="slot substitute";
      slot.innerHTML=`<h4>${sub}</h4><span>Substitute Assigned</span>`;
    }
    table.appendChild(slot);
  });
}

/* Logout */
function logout(){
  localStorage.removeItem("currentUser");
  location.href="index.html";
}

loadTimetable();
</script>

</body>
</html>
