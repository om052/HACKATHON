<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Teacher Dashboard | Smart Classroom</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif}
body{
  background:linear-gradient(135deg,#134e5e,#71b280);
  color:#fff;
}
.app{display:flex;min-height:100vh}

/* Sidebar */
.sidebar{
  width:230px;
  background:rgba(255,255,255,0.12);
  backdrop-filter:blur(16px);
  padding:25px;
}
.sidebar h2{margin-bottom:30px;font-size:1.2rem}
.sidebar a{
  display:block;
  padding:10px 14px;
  border-radius:12px;
  color:#fff;
  text-decoration:none;
  margin-bottom:10px;
  font-size:.9rem;
}
.sidebar a.active,.sidebar a:hover{
  background:rgba(255,255,255,0.2)
}

/* Main */
.main{flex:1;padding:25px 30px}

/* Topbar */
.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:30px;
}
.role{
  background:#43e97b;
  color:#000;
  padding:4px 10px;
  border-radius:12px;
  font-size:.75rem;
}
.logout{
  background:#ff6b6b;
  border:none;
  padding:8px 16px;
  border-radius:20px;
  cursor:pointer;
}

/* Section */
.section{
  background:rgba(255,255,255,0.14);
  backdrop-filter:blur(14px);
  padding:22px;
  border-radius:20px;
  margin-bottom:30px;
}
.section h3{margin-bottom:8px}
.section small{opacity:.85}

/* Timetable */
.table{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:14px;
  margin-top:15px;
}
.slot{
  background:rgba(255,255,255,0.18);
  padding:16px;
  border-radius:16px;
  text-align:center;
  font-size:.85rem;
}

/* Request */
textarea{
  width:100%;
  background:rgba(255,255,255,0.18);
  border:none;
  border-radius:14px;
  padding:14px;
  color:#fff;
  resize:none;
  margin-top:10px;
}
button{
  margin-top:12px;
  background:#43e97b;
  border:none;
  padding:10px 18px;
  border-radius:14px;
  font-weight:600;
  cursor:pointer;
}
.success{
  margin-top:10px;
  font-size:.85rem;
  color:#b9ffcc;
}
</style>
</head>

<body>
<div class="app">

<!-- Sidebar -->
<aside class="sidebar">
  <h2>Smart Classroom</h2>
  <a class="active">Dashboard</a>
  <a>My Timetable</a>
  <a>Requests</a>
</aside>

<!-- Main -->
<main class="main">

<!-- Topbar -->
<div class="topbar">
  <h3 id="welcome"></h3>
  <button class="logout" onclick="logout()">Logout</button>
</div>

<!-- Timetable -->
<div class="section">
  <h3>ðŸ“… My Timetable</h3>
  <small>Generated by Admin using Google Gemini</small>

  <div class="table" id="table"></div>
</div>

<!-- Request -->
<div class="section">
  <h3>ðŸ¤– AI Request to Admin</h3>
  <small>Powered by Google Gemini (AI-assisted scheduling request)</small>

  <textarea id="reqText" rows="4"
    placeholder="Example: Request leave for FE Maths tomorrow OR request period swap..."></textarea>

  <button onclick="sendRequest()">Send Request via Gemini</button>
  <div class="success" id="msg"></div>
</div>

</main>
</div>

<script>
/* SESSION */
const user = JSON.parse(localStorage.getItem("currentUser"));
if(!user || user.role!=="teacher") location.href="index.html";
welcome.innerHTML = `Welcome, ${user.name} <span class="role">Teacher</span>`;

/* SUBJECT MAP */
const subjects={
  FE:["Maths","Physics","Chemistry","English"],
  SE:["DSA","OOP","DBMS","Maths"],
  TE:["OS","CN","AI","SE"],
  BE:["Project","ML","Cloud","Elective"]
};

/* LOAD TIMETABLE (Admin Generated) */
function loadTimetable(){
  table.innerHTML="";
  const year="FE"; // demo default
  subjects[year].forEach((s,i)=>{
    const div=document.createElement("div");
    div.className="slot";
    div.innerHTML=`${s}<br>${user.name}`;
    table.appendChild(div);
  });
}

/* SEND REQUEST */
function sendRequest(){
  const text=reqText.value.trim();
  if(!text) return;

  const reqs=JSON.parse(localStorage.getItem("teacher_requests"))||[];
  reqs.push({
    text:`${user.name} (AI Request): ${text}`
  });
  localStorage.setItem("teacher_requests",JSON.stringify(reqs));

  msg.innerText="Request sent to Admin (processed by Gemini AI)";
  reqText.value="";
}

/* LOGOUT */
function logout(){
  localStorage.removeItem("currentUser");
  location.href="index.html";
}

loadTimetable();
</script>

</body>
</html>
